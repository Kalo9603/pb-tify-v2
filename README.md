# Template to create web components extending TEI Publisher pb-components

This is a template repository you can clone to quickly get started writing your own web component library, which extends the [pb-components](https://gitlab.existsolutions.com/tei-publisher/pb-components) of TEI Publisher. It includes a simple example component: `pb-clipboard`, and the necessary setup to

* run a development server to test components
* generate an API documentation with demos
* bundle the library for distribution
* localize components via i18n

A more beginner-friendly walk-trough is included in the TEI Publisher documentation.

##  Getting started

To get started, run `npm install`. This will install required dependencies: above all `pb-components` but also the `es-dev-server` and `web-component-analyzer` packages which are needed for local development and documentation.

Afterwards, run `npm start` to launch a development server. This will open a browser window pointing to `index.html`, which shows example usage of the `pb-clipboard` component. You can also browse to `api.html` to see the generated API documentation for the component. This is extracted from the [documentation-style comments](https://www.npmjs.com/package/web-component-analyzer#%E2%9E%A4-how-to-document-your-components-using-jsdoc) in the code.

The source code of new component should be placed into the `src` directory. For bundling, any new component must also be imported by `pb-extension-bundle.js`.

## Bundling for distribution

To create a bundle of the library, call

`npm run build:production`

The bundle (written into `dist`) will include everything, i.e. the version of the `pb-components` library you are building upon and all dependencies. You can thus use it as a drop-in replacement for TEI Publisher components or custom apps generated by TEI Publisher.

## Using in TEI Publisher or generated apps

The created library can be used as a drop-in replacement for the default `pb-components` library. To do so:

1. clone `tei-publisher-app` or the generated app you would like to modify
2. edit `package.json` and replace the dependency for `@teipublisher/pb-components` with the replacement library
3. edit `build.properties` and change `scripts.dir` to point to the replacement library
4. call `ant` to build tei-publisher-app

For example, to use the git source of `pb-extension-template` in `package.json`, change the dependencies as follows:

```json
"dependencies": {
    "@teipublisher/pb-extension-template": "git+https://github.com/eeditiones/pb-extension-template#master"
}
```

then change `build.properties` to contain:

```
scripts.dir=node_modules/@teipublisher/pb-extension-template/dist
```

Building tei-publisher-app should then copy scripts and resources from `pb-extension-template` instead of `pb-components`.